(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/myteaching/cropperPhoto"],{383:
/*!*******************************************************************************!*\
  !*** E:/code/work/wxapp/main.js?{"page":"pages%2Fmyteaching%2FcropperPhoto"} ***!
  \*******************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";(function(t){o(/*! uni-pages */4),o(/*! @dcloudio/uni-stat */5);c(o(/*! vue */2));var e=c(o(/*! ./pages/myteaching/cropperPhoto.vue */384));function c(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["createPage"])},384:
/*!************************************************************!*\
  !*** E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue ***!
  \************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var c=o(/*! ./cropperPhoto.vue?vue&type=template&id=8a70b9dc& */385),a=o(/*! ./cropperPhoto.vue?vue&type=script&lang=js& */387);for(var n in a)"default"!==n&&function(t){o.d(e,t,(function(){return a[t]}))}(n);o(/*! ./cropperPhoto.vue?vue&type=style&index=0&lang=scss& */389);var s,r=o(/*! ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */16),i=Object(r["default"])(a["default"],c["render"],c["staticRenderFns"],!1,null,null,null,!1,c["components"],s);i.options.__file="pages/myteaching/cropperPhoto.vue",e["default"]=i.exports},385:
/*!*******************************************************************************************!*\
  !*** E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=template&id=8a70b9dc& ***!
  \*******************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,o){"use strict";o.r(e);var c=o(/*! -!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropperPhoto.vue?vue&type=template&id=8a70b9dc& */386);o.d(e,"render",(function(){return c["render"]})),o.d(e,"staticRenderFns",(function(){return c["staticRenderFns"]})),o.d(e,"recyclableRender",(function(){return c["recyclableRender"]})),o.d(e,"components",(function(){return c["components"]}))},386:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=template&id=8a70b9dc& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(t,e,o){"use strict";var c;o.r(e),o.d(e,"render",(function(){return a})),o.d(e,"staticRenderFns",(function(){return s})),o.d(e,"recyclableRender",(function(){return n})),o.d(e,"components",(function(){return c}));var a=function(){var t=this,e=t.$createElement;t._self._c},n=!1,s=[];a._withStripped=!0},387:
/*!*************************************************************************************!*\
  !*** E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=script&lang=js& ***!
  \*************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var c=o(/*! -!./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropperPhoto.vue?vue&type=script&lang=js& */388),a=o.n(c);for(var n in c)"default"!==n&&function(t){o.d(e,t,(function(){return c[t]}))}(n);e["default"]=a.a},388:
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=script&lang=js& ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=o(/*! ../../js_sdk/gsq-image-tools/image-tools/index.js */364),a=t.getSystemInfoSync(),n=a.screenWidth;console.log("SCREEN_WIDTH",n);a.pixelRatio;var s,r,i,u,p,h,l,d,g,f,m,v=1,y=100,R=a.screenWidth,b={data:function(){return{name:"chad",imageSrc:"",token:"",isphbox:!0,pic:"",flag:!0,isShowImg:!1,isWorH:!0,cropperInitW:n,cropperInitH:n,cropperW:n,cropperH:n,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:n,cutR:"100%",qualityWidth:R,innerAspectRadio:v,title:"",subject_name:"",RateXYZ:{x:0,y:0,z:0}}},onLoad:function(e){var o=e.ImagePath,c=e.textbook_id,a=e.choosePage,n=e.title,s=e.subject_name;console.log("onLoad",o),this.imageSrc=o,this.textbook_id=c,this.choosePage=a,this.title=n,this.subject_name=s,t.getStorageSync("userInfo").token&&(this.token=t.getStorageSync("userInfo").token)},onReady:function(){this.loadImage()},methods:{Gyroscopestart:function(){var e=this;t.startGyroscope({interval:"normal",success:function(){console.log("success")},fail:function(){console.log("fail")}}),t.onGyroscopeChange((function(t){var o=t.x,c=t.y,a=t.z;e.setData({RateXYZ:{x:o,y:c,z:a}}),console.log("gyroData.RateXYZ = ",e.RateXYZ),e.Gyroscopestop()}))},Gyroscopestop:function(){t.stopGyroscope({success:function(){console.log("stop success!")},fail:function(){console.log("stop fail!")}})},speedprogress:function(){var t=this;this.uploadTask.onProgressUpdate((function(e){console.log("上传进度"+e.progress),t.percent=e.progress}))},setData:function(t){var e=this;Object.keys(t).forEach((function(o){e.$set(e.$data,o,t[o])}))},getImage:function(){console.log("返回上个页面getImage"),t.navigateBack({delta:1})},loadImage:function(){var e=this;t.showLoading({title:"图片加载中..."}),t.getImageInfo({src:e.imageSrc,success:function(o){g=o.width/o.height,g>=1?(f=n,m=n/g):(f=n*g,m=n);var c=f>m?f:m;if(y=c>y?y:c,g>=1){var a=Math.ceil((n*g-n*g)/2)+25,s=a,r=0,i=r;e.setData({cropperW:n,cropperH:n/g,cropperL:Math.ceil((n-n)/2),cropperT:Math.ceil((n-n/g)/2),cutL:a,cutT:r,cutR:s,cutB:i,imageW:f,imageH:m,scaleP:f/n,qualityWidth:R,innerAspectRadio:g})}else{var u=Math.ceil((n*g-n*g)/2)+30,p=u,h=Math.ceil((n-y)/2)+30,l=h;e.setData({cropperW:n,cropperH:n/g,cropperL:Math.ceil((n-n*g)/2),cropperT:Math.ceil((n-n)/2),cutL:u,cutT:h,cutR:p,cutB:l,imageW:f,imageH:m,scaleP:f/n,qualityWidth:R,innerAspectRadio:g})}e.setData({isShowImg:!0}),t.hideLoading()}})},contentStartMove:function(t){s=t.touches[0].pageX,r=t.touches[0].pageY},contentMoveing:function(t){var e=(s-t.touches[0].pageX)*v,o=(r-t.touches[0].pageY)*v;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),o>0?this.cutT-o<0&&(o=this.cutT):this.cutB+o<0&&(o=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-o,cutR:this.cutR+e,cutB:this.cutB+o}),s=t.touches[0].pageX,r=t.touches[0].pageY},contentTouchEnd:function(){},search_exercises:function(){var e=this;this.$api.orc_one({textbook_id:this.textbook_id,pic:this.pic,token:this.token}).then((function(o){console.log("res",o);var c=o.result;console.log("result",c),200==o.code?1==o.data.data.length?t.redirectTo({url:"/pages/knowledgeBase/watchExplane?id="+o.data.data[0].exercises_id+"&source=1"}):t.redirectTo({url:"/pages/myPaper/seePapers?status=photo&listData="+encodeURIComponent(JSON.stringify(o.data.data))+"&title="+e.title+"&subject_name="+e.subject_name+"&source=1"}):t.showToast({title:o.msg,icon:"none"}),e.flag=!1,e.percent=0,e.iscmdProgress=!1}))},base64:function(e){var o=e.url,c=e.type;return new Promise((function(e,a){t.getFileSystemManager().readFile({filePath:o,encoding:"base64",success:function(t){e("data:image/"+c.toLocaleLowerCase()+";base64,"+t.data)},fail:function(t){return a(t.errMsg)}})}))},getImageInfo:function(){var e=this,o=this;t.showLoading({title:"图片生成中..."});var a=t.createCanvasContext("myCanvas");a.drawImage(o.imageSrc,0,0,f,m),a.draw(!1,(function(){var a=(o.cropperW-o.cutL-o.cutR)/o.cropperW*f,n=(o.cropperH-o.cutT-o.cutB)/o.cropperH*m,s=o.cutL/o.cropperW*f,r=o.cutT/o.cropperH*m,i=a/n;console.log("numResul",i),e.isWorH=!(i<1),t.canvasToTempFilePath({x:s,y:r,width:a,height:n,destWidth:4*a,destHeight:4*n,fileType:"png",quality:1,canvasId:"myCanvas",success:function(o){t.hideLoading(),(0,c.pathToBase64)(o.tempFilePath).then((function(t){console.log(t),e.isphbox=!1,e.flag=!0,e.pic=t,e.search_exercises()})).catch((function(e){console.error(e),t.showToast({title:"上传图片失败",icon:"none"}),t.navigateBack()}))}})}))},dragStart:function(t){i=t.touches[0].pageX,u=t.touches[0].pageY,p=this.cutL,l=this.cutR,d=this.cutB,h=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var o=(i-t.touches[0].pageX)*v;l+o<0&&(o=-l),this.setData({cutR:l+o});break;case"left":o=(i-t.touches[0].pageX)*v;p-o<0&&(o=p),p-o>this.cropperW-this.cutR&&(o=p-(this.cropperW-this.cutR)),this.setData({cutL:p-o});break;case"top":o=(u-t.touches[0].pageY)*v;h-o<0&&(o=h),h-o>this.cropperH-this.cutB&&(o=h-(this.cropperH-this.cutB)),this.setData({cutT:h-o});break;case"bottom":o=(u-t.touches[0].pageY)*v;d+o<0&&(o=-d),this.setData({cutB:d+o});break;case"rightBottom":var c=(i-t.touches[0].pageX)*v,a=(u-t.touches[0].pageY)*v;d+a<0&&(a=-d),l+c<0&&(c=-l);var n=d+a,s=l+c;this.setData({cutB:n,cutR:s});break;default:break}}}};e.default=b}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])},389:
/*!**********************************************************************************************!*\
  !*** E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=style&index=0&lang=scss& ***!
  \**********************************************************************************************/
/*! no static exports found */function(t,e,o){"use strict";o.r(e);var c=o(/*! -!./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cropperPhoto.vue?vue&type=style&index=0&lang=scss& */390),a=o.n(c);for(var n in c)"default"!==n&&function(t){o.d(e,t,(function(){return c[t]}))}(n);e["default"]=a.a},390:
/*!************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!./node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-2!./node_modules/postcss-loader/src??ref--8-oneOf-1-3!./node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--8-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/code/work/wxapp/pages/myteaching/cropperPhoto.vue?vue&type=style&index=0&lang=scss& ***!
  \************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(t,e,o){}},[[383,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/myteaching/cropperPhoto.js.map